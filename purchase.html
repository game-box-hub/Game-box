<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Purchase / Sell</title>
</head>
<body>
  <h2>Sell Your Account</h2>
  
  <label>Enter Your ID:</label><br>
  <input type="text" id="playerID"><br><br>

  <label>Enter Your Level:</label><br>
  <input type="text" id="level"><br><br>

  <label>Game Name:</label><br>
  <select id="game">
    <option value="PUBG Mobile / BGMI">PUBG Mobile / BGMI</option>
    <option value="PUBG Lite">PUBG Lite</option>
    <option value="Free Fire">Free Fire</option>
  </select><br><br>

  <label>Upload Video Proof:</label><br>
  <input type="file" id="videoFile" accept="video/*"><br><br>

  <!-- Fixed button -->
  <button type="button" onclick="saveData()">Submit</button>

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAbWLhXk_nrh7FwTy17jDp3MKqxqtooZ78",
      authDomain: "gamebox-a049d.firebaseapp.com",
      databaseURL: "https://gamebox-a049d-default-rtdb.firebaseio.com",
      projectId: "gamebox-a049d",
      storageBucket: "gamebox-a049d.appspot.com",
      messagingSenderId: "978725902064",
      appId: "1:978725902064:web:1793d66e2fc29910d05435"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const storage = firebase.storage();

    async function saveData() {
      let playerID = document.getElementById("playerID").value;
      let level = document.getElementById("level").value;
      let game = document.getElementById("game").value;
      let file = document.getElementById("videoFile").files[0];

      if (!playerID || !level || !file) {
        alert("⚠️ Please fill all fields and upload a video!");
        return;
      }

      try {
        let fileName = "videos/" + Date.now() + "_" + file.name;
        let storageRef = storage.ref(fileName);

        // Upload video
        await storageRef.put(file);
        console.log("✅ Video Uploaded:", fileName);

        let videoURL = await storageRef.getDownloadURL();

        // Save data in DB
        await db.ref("accounts/").push({
          playerID: playerID,
          level: level,
          game: game,
          video: videoURL,
          date: new Date().toLocaleString()
        });

        alert("✅ Account & Video saved successfully!");

      } catch (error) {
        console.error("❌ Error:", error);
        alert("Upload failed. Please try again.");
      }
    }
  </script>
</body>
</html>
